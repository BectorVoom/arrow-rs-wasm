[package]
name = "arrow-wasm"
version = "0.1.0"
edition = "2021"
description = "WebAssembly library for Arrow/Feather data with zero-copy ownership semantics"
license = "MIT OR Apache-2.0"
authors = ["Generated by Claude Code"]
repository = "https://github.com/BectorVoom/arrow2-wasm"
keywords = ["arrow", "feather",  "zero-copy", "ipc"]
categories = ["data-structures", "encoding"]

readme = "README.md"

# Configure as a WASM library
[lib]
crate-type = ["cdylib", "rlib"]

[dependencies]
# Core Arrow dependencies for IPC and data structures (WASM-compatible features only)
arrow = {version="56.1.0", default-features = false, features=["ipc"]}
arrow-ipc = {version="56.1.0", default-features = false}
arrow-array = {version="56.1.0", default-features = false}
arrow-schema = {version="56.1.0", default-features = false}
arrow-buffer = {version="56.1.0", default-features = false}
arrow-data = {version="56.1.0", default-features = false}
arrow-select = {version="56.1.0", default-features = false}
arrow-cast = {version="56.1.0", default-features = false}
arrow-ord = {version="56.1.0", default-features = false}

# WASM and JavaScript interop
wasm-bindgen = "0.2"
wasm-bindgen-futures = "0.4"
js-sys = "0.3"
web-sys = { version = "0.3", features = ["console"] }
serde-wasm-bindgen = "0.4"

# Error handling and utilities
anyhow = "1.0"
thiserror = "1.0"
console_error_panic_hook = { version = "0.1", optional = true }
once_cell = "1.20"

# LZ4 compression support (disabled for initial WASM compatibility)
# lz4_flex = "0.11"

# Serialization support for debugging/diagnostics
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"

# Features for conditional compilation
[features]
default = ["console_error_panic_hook", "simd"]
debug = ["console_error_panic_hook"]
simd = []
bulk_allocation = []
buffer_pooling = []

# WASM-specific optimization profiles
[profile.release]
opt-level = 3
lto = true
codegen-units = 1
panic = "abort"
strip = true

# Optimize for size and performance in WASM
[profile.wasm-release]
inherits = "release"
opt-level = "s"
lto = true
codegen-units = 1
panic = "abort"

# Development profile optimized for WASM debugging
[profile.wasm-dev]
inherits = "dev"
opt-level = 1
debug = true
panic = "abort"

# Package metadata for wasm-pack configuration
[package.metadata.wasm-pack.profile.release]
wasm-opt = false

[package.metadata.wasm-pack.profile.dev]
wasm-opt = false

# Linting configuration (allow unsafe for WASM memory operations)
[lints.rust]
missing_docs = "warn"
unsafe_code = "allow"  # Required for WASM memory operations

[lints.clippy]
all = "warn"
nursery = "warn"
pedantic = "warn"
cargo = "warn"
# Allow some patterns common in WASM development
cast_ptr_alignment = "allow"
cast_possible_truncation = "allow"

